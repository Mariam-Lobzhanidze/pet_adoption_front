<div class="d-flex flex-column gap-3">
  <button
    class="add-btn btn btn-secondary text-light d-flex align-items-center gap-2 p-0"
    (click)="fileInput.click()"
  >
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256">
      <rect width="256" height="256" fill="none" />
      <line
        x1="40"
        y1="128"
        x2="216"
        y2="128"
        fill="none"
        stroke="currentColor"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="16"
      />
      <line
        x1="128"
        y1="40"
        x2="128"
        y2="216"
        fill="none"
        stroke="currentColor"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="16"
      />
    </svg>
    <input
      #fileInput
      type="file"
      accept="image/*"
      (change)="fileChangeEvent($event)"
      hidden
      class="d-none"
    />
  </button>

  <div class="d-flex flex-lg-row flex-column flex-sm-column-reverse gap-2">
    @if(activeImageFile) {
    <div class="flex-fill">
      <image-cropper
        [imageFile]="activeImageFile"
        [maintainAspectRatio]="true"
        [aspectRatio]="6 / 7"
        format="webp"
        (imageCropped)="imageCropped($event)"
      ></image-cropper>

      <!-- (imageLoaded)="imageLoaded($event)"
        (cropperReady)="cropperReady()"
        (loadImageFailed)="loadImageFailed()" -->
    </div>
    }

    <div class="d-flex flex-lg-column flex-lg-nowrap flex-wrap gap-2">
      @for (image of uploadedImages; track image.id) { @if (image.croppedUrl) {
      <div
        class="card shadow position-relative"
        (click)="onShowImage(image.id)"
        [ngClass]="{
          'border border-secondary border-2': image.id === activeImageId
        }"
      >
        <img
          class="position-absolute top-0 start-0 object-fit-cover w-100 h-100 rounded"
          [src]="image.croppedUrl"
          alt="Cropped Image"
        />

        <button
          class="shadow x-icon btn d-flex align-items-center justify-content-center"
          type="button"
          (click)="deleteImage(image.id)"
        >
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256">
            <rect width="256" height="256" fill="none" />
            <line
              x1="200"
              y1="56"
              x2="56"
              y2="200"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="16"
            />
            <line
              x1="200"
              y1="200"
              x2="56"
              y2="56"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="16"
            />
          </svg>
        </button>
      </div>
      } }
    </div>
  </div>
</div>
